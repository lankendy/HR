<div class="search-country-modal">
    <nz-modal [(nzVisible)]="isVisible" [nzTitle]="title" [nzFooter]="modalFooter" [nzWidth]="1300" (nzOnCancel)="handleCancel()">
        <page-grid>
            <div nz-row>
                <div nz-col nzSpan="24">
                    <input nz-input placeholder="Tìm..." class="input-search" [(ngModel)]="request.fulltextsearch" (keyup.enter)="nzOnSearch($event)" />
                </div>
            </div>
            <div nz-row>
                <div nz-col nzSpan="24">
                    <div nz-row>
                        <div nz-col nzSpan="6">
                            <nz-select class="select-search" nzPlaceHolder="{{ 'layout.search.group' | translate }}" nzAllowClear [ngModel]="groupBy" (ngModelChange)="nzOnSearchGroup($event)">
                                <nz-option nzValue="countryCode" nzLabel="Mã"> </nz-option>
                            </nz-select>
                        </div>
                        <div nz-col nzSpan="18">
                            <nz-pagination class="float-right mr-2" [(nzPageSize)]="request.size" [(nzPageIndex)]="request.page" (nzPageIndexChange)="nzPageIndexChange($event)" [nzShowTotal]="totalTemplate" [(nzTotal)]="total">
                            </nz-pagination>
                            <ng-template #totalTemplate let-total>
                                {{ request.size * (request.page - 1) + 1 }} -{{ request.page * request.size > total ? total : request.page * request.size }} /{{ total }}
                            </ng-template>
                        </div>
                    </div>
                </div>
            </div>
            <div nz-row>
                <nz-card class="w-100">
                    <nz-table [nzLoading]="loading" #rowSelectionTable nzBordered [nzData]="resCountries" [nzFrontPagination]="false">
                        <thead (nzSortChange)="nzSortChange($event)">
                            <tr class="ant-header-customize">
                                <th nzWidth="50px" nzShowExpand *ngIf="expandable"></th>
                                <th *ngIf="expandable"></th>
                                <th nzShowSort nzSortKey="countryCode">Mã</th>
                                <th nzShowSort nzSortKey="name">Tên quốc gia</th>
                            </tr>
                        </thead>
                        <tbody>
                            <ng-template ngFor let-data [ngForOf]="rowSelectionTable.data">
                                <tr [ngClass]="{ 'col-group': expandable }" (click)="!expandable && onSelectRow(data)">
                                    <td *ngIf="expandable"></td>
                                    <td nzShowExpand *ngIf="expandable" [(nzExpand)]="data.expand"></td>
                                    <td *ngIf="expandable" [ngClass]="{ 'col-group-text': expandable }">
                                        {{ data[groupBy] }}
                                    </td>
                                    <td>{{ expandable ? '' : data.countryCode }}</td>
                                    <td>{{ expandable ? '' : data.name }}</td>
                                </tr>
                                <tr [nzExpand]="data.expand" *ngFor="let item of data.children" (click)="onSelectRow(item)">
                                    <td></td>
                                    <td></td>
                                    <td>{{ item.countryCode }}</td>
                                    <td>{{ item.name }}</td>
                                </tr>
                            </ng-template>
                        </tbody>
                    </nz-table>
                </nz-card>
            </div>
            <ng-template #modalFooter>
                <button nz-button nzType="default" (click)="handleCancel()">{{ 'layout.btn.cancel' | translate }}</button>
            </ng-template>
        </page-grid>
    </nz-modal>
</div>
